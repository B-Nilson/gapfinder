<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Optimize coverage of locations by a set of installations within a desired distance. — optimize_coverage • gapfinder</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Optimize coverage of locations by a set of installations within a desired distance. — optimize_coverage"><meta property="og:description" content="Finds the smallest subset of points that covers all possible locations within a given distance.
Allows for weighting of both locations to cover and installation locations based on columns in the data frames.
For example, you may want to weight cities over villages for ease of installation,
and you may want to prioritize higher populations to cover."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gapfinder</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimize coverage of locations by a set of installations within a desired distance.</h1>

    <div class="hidden name"><code>optimize_coverage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Finds the smallest subset of points that covers all possible locations within a given distance.
Allows for weighting of both locations to cover and installation locations based on columns in the data frames.</p>
<p>For example, you may want to weight cities over villages for ease of installation,
and you may want to prioritize higher populations to cover.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optimize_coverage</span><span class="op">(</span></span>
<span>  <span class="va">install_at</span>,</span>
<span>  <span class="va">to_cover</span>,</span>
<span>  existing_locations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cover_distance <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">25</span>, <span class="st">"km"</span><span class="op">)</span>,</span>
<span>  weight_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".weight"</span>, <span class="st">".weight"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-install-at">install_at<a class="anchor" aria-label="anchor" href="#arg-install-at"></a></dt>
<dd><p>An <code>sf</code> data frame containing the locations of the to consider for installation.</p></dd>


<dt id="arg-to-cover">to_cover<a class="anchor" aria-label="anchor" href="#arg-to-cover"></a></dt>
<dd><p>An <code>sf</code> data frame containing the locations desired to be covered by <code>install_at</code> within <code>cover_distance</code>.</p></dd>


<dt id="arg-existing-locations">existing_locations<a class="anchor" aria-label="anchor" href="#arg-existing-locations"></a></dt>
<dd><p>A data frame containing the locations of existing installations.
<code>to_cover</code> will be filtered to exclude points that are already covered by <code>existing_locations</code>.
Defaults to <code>NULL</code> - no filtering is done.</p></dd>


<dt id="arg-cover-distance">cover_distance<a class="anchor" aria-label="anchor" href="#arg-cover-distance"></a></dt>
<dd><p>The distance from an installation that a location is considered to be covered.
Expected to be a <code>units</code> object, otherwise a <code>numeric</code> which is assumed to be in km.
Defaults to 25 km.</p></dd>


<dt id="arg-weight-columns">weight_columns<a class="anchor" aria-label="anchor" href="#arg-weight-columns"></a></dt>
<dd><p>A character vector containing the names of the columns in <code>install_at</code> and <code>to_cover</code>
that should be used as weights when calculating the coverage of each potential installation.
A weight of 2 is akin to double coverage from/for that location.
If no columns in <code>install_at</code> or <code>to_cover</code> match the respective names in <code>weight_columns</code>,
then equal weighting for all of those locations is assumed.
If only one column is provided, it will be used for both <code>install_at</code> and <code>to_cover</code>.
Defaults to c(".weight", ".weight"), equivalent to ".weight".</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame containing the subset of installations that cover the most points with the least number of installations, weighted by <code>weight_columns</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gapfinder</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/is_installed.html" class="external-link">check_installed</a></span><span class="op">(</span><span class="st">"canadata"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define where we could install monitors (canadian communities)</span></span></span>
<span class="r-in"><span><span class="va">install_at</span> <span class="op">&lt;-</span> <span class="fu">canadata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/canadata/man/communities.html" class="external-link">communities</a></span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lng"</span>, <span class="st">"lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="st">"WGS84"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="co"># Cities are easier to install than hamlets</span></span></span>
<span class="r-in"><span>  <span class="co"># here they provide 4x more coverage (4 levels of type)</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ease_of_install <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define what we want the monitors to cover (canadian population)</span></span></span>
<span class="r-in"><span><span class="va">to_cover</span> <span class="op">&lt;-</span> <span class="fu">canadata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/canadata/man/gridded_2016_population.html" class="external-link">gridded_2016_population</a></span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lng"</span>, <span class="st">"lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="st">"WGS84"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define existing monitors</span></span></span>
<span class="r-in"><span><span class="va">existing_locations</span> <span class="op">&lt;-</span> <span class="st">"https://aqmap.ca/aqmap/data/aqmap_most_recent_obs.csv"</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>site_id <span class="op">=</span> <span class="va">sensor_index</span>, <span class="va">network</span>, <span class="va">lng</span>, <span class="va">lat</span>, name <span class="op">=</span> <span class="va">monitor</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lng"</span>, <span class="st">"lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="st">"WGS84"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find the optimal locations for 50 km coverage</span></span></span>
<span class="r-in"><span><span class="co"># Coverage depends on population x ease of install within 50 km of each monitor</span></span></span>
<span class="r-in"><span><span class="va">optimized_locations</span> <span class="op">&lt;-</span> <span class="fu">optimize_coverage</span><span class="op">(</span></span></span>
<span class="r-in"><span>  install_at <span class="op">=</span> <span class="va">install_at</span>,</span></span>
<span class="r-in"><span>  to_cover <span class="op">=</span> <span class="va">to_cover</span>,</span></span>
<span class="r-in"><span>  existing_locations <span class="op">=</span> <span class="va">existing_locations</span>,</span></span>
<span class="r-in"><span>  cover_distance <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"km"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  weight_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ease_of_install"</span>, <span class="st">"total_population"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Brayden Nilson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

